---
layout: single
title:  "HTTP 다시 정리1.1"
---

# HTTP 요약 1-1

## 웹 브라우저 요청 흐름

### https://www.google.com:443/search?q=hello&hl=ko

    웹 브라우저에서 검색창에 위 경로로 검색을 딱 하면, 일단 DNS 서버를 조회해서 구글 IP를 알아내고, HTTPS 는 생략하면 포트는443, 이런식으로 포트 번호를 알아낸다. 그리고 HTTP 요청 메시지가 만들어진다. 이 메시지가 소켓 라이브러리로 전달되고 이를 통해서 TCP/IP 계층으로 전달되면, TCP가 신, 신액, 액 -> 3핸드 쉐이킹을 하고 딱 구글(서버)에 연결이 되면 TCP/IP 패킷화를 하고 인터넷 망으로 전달되서 최종적으로 구글 서버에 데이터를 전달한다. 그리고 서버에서도 똑같이 HTTP 응답 메세지를 만들어서 3핸드 쉐이킹 하고 전달되면 전달된 바디 데이터로 렌더링을 하건 뭘 하건 동작한다.

## 대부분 모든 데이터는 HTTP 메세지로 전달된다

    HTTP는 버전이 1.1이 가장 많이 사용되고, 2, 3도 있는데, 1.1, 2는 TCP 기반이고, 3은 UDP 기반인데, 2, 3은 1.1의 성능 개선 버전이고, 3이 UDP 기반인 이유는 TCP는 3핸드 쉐이킹(연결하는 시간, 느림), 포트나 부가정보들을 많이 넘겨서 무거움, 아무튼 무겁고 느린데 이걸 UDP가 성능 최적화하는데 이용함.

## HTTP 특징

### 1. 클라이언트 - 서버 구조이다.
        HTTP는 클라이언트가 HTTP 메세지를 통해 요청을 만들어 서버에 보내면 서버에서 응답을 내려줄때까지 대기한다. 
        그리고 서버에서 응답을 주면 동작한다. 이렇게 두개로 구분한게 중요하다. 
        일단 서버에는 데이터, 비지니스로직 등을 관리한다. 그리고 클라이언트는 UI나 사용성에 집중한다. 
        이러면 두개가 독립적으로 진화할수있다.

### 2. 무상태 프로토콜을 지향한다.
    엄청난 확장성을 가져올수있는 특징이다. 만약 상태유지를 지양한다면, 즉 문맥을 이어가는 요청과 응답이라면, 중간에 서버가 바뀌어 버리면 문맥을 이해못하므로, 다시 처음부터 문맥을 쌓아야한다. 하지만 무상태는 애초에 문맥을 쌓을 필요도 없이 클라이언트가 응답에 필요한 걸 요청에 다 담아서 보내버리면, 서버가 바뀌어도 처리가능하다. 이게 뭐냐..? 바로 클라이언트 요청이 많아지면 무상태라면 그냥 서버 냅다 증설할수있다는거다. 무상태의 단점이라고 한다면, 한번에 요청에 다 담아야 하니까 보낼게 좀 많다? 그리고 로그인, 쿠키, 세션 이런 곳에서는 무상태이면 힘들다? 정도있다. 최대한 무상태로 설계하자로 기억하자.

### 3. 비연결성
    연걸을 계속 유지한다면? -> 요청이 와서 응답을 해도 연결되있는데, 또 다른 요청이 오면 이것도 연결되있고, 그럼 전에 연결 한것들 중에 응답 다해도 놀고있는 연결이 있을것이니 서버의 연결 자원이 손해를 보고있는거다.
    연결을 바로 끊는다면? -> 요청이 오고 응답이 끝나면 딱 끊어버린다면 서버의 연결 자원은 아낄수있다. 하지만 그럼 요청을 또 하면 또 연결을 해야한다. 기본적으로 3핸드 쉐이킹을 하는데, 시간이 걸린다.. 그리고 서버의 자원을 방금전에 다운로드 받았을텐데도 끊어지면 다시 받아야한다. 시간이 걸린다..
    이를 지속연결로 해결한다. -> 그냥 어느정도 시간을 정해놓고 요청이 오고 응답을 하고 일정시간이 지나면 끊어지게 해서 해결했단다.

## HTTP 메시지 구조

### 1. 시작라인
    요청 메시지 부터 하자면,
    GET / search?q=hello&hl=ko HTTP/1.1 -> 요청 메시지의 시작라인
    GET 부분은 HTTP 메서드이다. GET은 리소스를 얻는다 그런 느낌이고 POST 등등이 더 있는데 POST는 전달하는 값으로 뭔가 처리할때 보통한다.
    search?q=hello&hl=ko 부분은 리소스 대상(절대경로) 이다. ? 뒤에는 쿼리 파라미터이다.
    HTTP/1.1 은 HTTP 버전이다.
    
    응답 메시지는
    HTTP/1.1 200 OK -> 응답 메시지의 시작라인
    HTTP 버전과 HTTP 상태코드가 나와있는데, 200은 정상처리 되었단 코드이고, 뒤에 OK는 사람이 알아듣기 좋게 쓴 글같은거다.

### 2. 헤더
    헤더는 요청과 응답 둘다 마찬가지 느낌인데
    메시지 바디에는 전달할 데이터가 들어있다면 헤더는 그 외 필요한 부가정보들을 포함하고있는 곳이다.
    Host : ~ 이런 느낌으로 키:벨류 느낌이다. 키는 대소문자 구분안하는데 키: 이거 띄어쓰기 하면안되고 둘다 붙어야한단다.
    

### 3. 공백라인
    말 그대로 공백인데, 스펙상 있단다.

### 4. 메시지 바디
    메시지 바디는 실제로 전달되는 데이터가 담기는 곳이다.
